<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.eBook.mgr.mapper.MemberMapper">

   <resultMap type="Member" id="memberMap">
      <id property="idx" column="idx" />
      <result property="idx" column="idx" />
      <result property="id" column="id" />
      <result property="pw" column="pw" />
      <result property="realName" column="real_name" />
      <result property="enabled" column="enabled" />
      <result property="loginStatus" column="login_status" />
      <result property="updDate" column="upd_date" />
      <collection property="authList" resultMap="authMap">
      </collection>
   </resultMap>

   <resultMap type="MemberAuth" id="authMap">
      <result property="idx" column="idx" />
      <result property="auth" column="auth" />
   </resultMap>
   
   <insert id="create">
      INSERT INTO member
         (
            id,
            pw,
            real_name
         )
      VALUES
         (
            #{id},
            #{pw},
            #{realName}
         )
   </insert>
   
   <insert id="createAuth">
      INSERT INTO member_auth
          (
            idx,
            auth
          )
      VALUES
          (
            #{idx},
            #{auth}
          )
   </insert>
   
   <select id="readByUserId" resultMap="memberMap">
   	SELECT mem.idx,
	   		mem.id,
	   		pw,
	   		real_name,
	   		login_status,
	   		reg_date,
	   		upd_date,
	   		auth
   	FROM  member mem LEFT OUTER JOIN member_auth auth ON mem.idx = auth.idx
   	WHERE mem.id = #{id}
   </select>
   
   <select id="list" resultType="Member">
   	SELECT idx,
   		id,
   		pw,
   		real_name,
   		reg_date
   	FROM member
   	ORDER BY reg_date DESC
   </select>
   
   <select id="read" resultMap="memberMap">
   	SELECT mem.idx,
   		mem.id,
   		pw,
   		real_name,
   		reg_date,
   		upd_date,
   		auth
   	FROM member mem LEFT OUTER JOIN member_auth auth
   		ON mem.idx = auth.idx
   	WHERE mem.id = #{id}
   </select>
   
</mapper>













